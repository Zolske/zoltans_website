<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords" content="Django Cheat Sheet, Django Cheat Sheet Notes" />
    <meta name="description" content="Zoltan's notes to Django Cheat Sheet." />
    <link rel="stylesheet" href="../../css/notes_navBar.css">
    <link rel="icon" href="../../images/logo/favicon/python.ico">
    <meta>
    <title>Cheat Sheet: Django</title>
</head>

<body>
    <main>
        <h1>Cheat Sheet: Django</h1>
        <table class="codExplain">
            <tr>
                <th>setting up a django project</th>
            </tr>
            <tr>
                <td>python -m venv .venv</td>
            </tr>
            <tr>
                <td>creates a "virtual environment" with the name <b>.venv</b> which is the conventional name</td>
            </tr>
            <tr>
                <td>.venv\Scripts\activate</td>
            </tr>
            <tr>
                <td>activates the "virtual environment" with the name <b>.venv</b></td>
            </tr>
            <tr>
                <td>deactivate</td>
            </tr>
            <tr>
                <td>deactivates the "virtual environment"</td>
            </tr>
            <tr>
                <td>git init</td>
            </tr>
            <tr>
                <td>creates a "local" git repository</td>
            </tr>
            <tr>
                <td>New-Item .gitignore. ; Set-Content .gitignore. '.venv/'</td>
            </tr>
            <tr>
                <td>create the hidden .gitignore file and add the hidden folder .venv with all its sub folders
                </td>
            </tr>
            <tr>
                <td>python -m pip install django</td>
            </tr>
            <tr>
                <td>install the Django package into the current directory</td>
            </tr>
            <tr>
                <td>django-admin startproject PROJECT_NAME .</td>
            </tr>
            <tr>
                <td>create a Django project with the name <b>PROJECT_NAME</b> (a good name is <b>config</b>)</td>
            </tr>
            <tr>
                <td>python -m venv <mark title="create a virtual environment in the hidden folder venv">.venv</mark><br>
                    .venv\Scripts\<mark title="activates the virtual environment">activate</mark><br>
                    git <mark title="initializes a local git repository">init</mark><br>
                    <mark title="creates a hidden gitignore file in 'power shell">New-Item .gitignore.</mark> ; <mark
                        title="writes into the .gitignore file in 'power shell', prevents the virtual environment from being submitted">Set-Content
                        .gitignore. '.venv/'</mark><br>
                    python -m pip <mark title="installs Django">install django</mark><br>
                    django-admin startproject <mark title="creates a django project 'django_project'">django_project
                        .</mark><br>
                    git <mark
                        title="add's all files (except .gitignore) and commit's them with the 'initial commit' message">add
                        . && git commit -m "initial commit"</mark><br>
                    gh <mark title="creates a gitHub repository">repo create</mark> <mark
                        title="repo is public use '--private' to make it private">--public</mark> <mark
                        title="specify the source directory which is the current .">--source=.</mark> <mark
                        title="sets the upstream, where to commit to, gitHub new created repo">--remote=upstream</mark>
                    <mark title="pushes the commit to gitHub">--push</mark><br>
                </td>
            </tr>
            <tr>
                <td>combines the previews commands and creates a repository on GitHub with the name of the root folder,
                    pushes commits
                </td>
            </tr>
            <tr>
                <td>python manage.py startapp APP_NAME</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>create a new django app with the name <b>APP_NAME</b></li>
                        <li>needs to be registered: <code>PROJECT_NAME/settings.py</code> under
                            <code>INSTALLED_APP</code> (<i>'<mark
                                    title="name of the app in lowercase">app_name</mark>.apps.<mark
                                    title="name of the app, capitalize the first letter">App_name</mark>Config'</i>)
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>python manage.py runserver</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>starts the local server on port 8000</li>
                        <li>appending a port number to the command runs the server on a different port</li>
                        <li>exit the server <code>Ctrl + c</code></li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>python manage.py migrate</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>creates a local database to which Django is migrating</li>
                        <li>migrate will sync the database with the current state of any database models contained in
                            the project and listed in INSTALLED_APPS</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>STATIC_ROOT = BASE_DIR / "staticfiles"<br>
                    STATICFILES_STORAGE = "django.contrib.staticfiles.storage.StaticFilesStorage"</td>
            </tr>
            <tr>
                <td>updated <b>django_project/settings.py</b> at the bottom: <ul>
                        <li>set the <a href="https://docs.djangoproject.com/en/4.0/ref/settings/#static-root"
                                target="_blank">STATIC_ROOT</a> configuration, which is the absolute location of these
                            collected files, to a folder called staticfiles.</li>
                        <li>set the <a href="https://docs.djangoproject.com/en/4.0/ref/settings/#staticfiles-storage"
                                target="_blank">STATICFILES_STORAGE</a>, which is the file storage engine used by
                            collectstatic</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>python manage.py collectstatic</td>
            </tr>
            <tr>
                <td>The command compiles all static files throughout the project into a singe directory ("staticfiles")
                    suitable for deployment.
                    <ul>
                        <li>staticfiles/admin :<br>
                            the folder and its content is automatically created</li>
                        <li>Before each new deployment, the collectstatic command must be run to compile them into this
                            staticfiles folder used in production.</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>python -m pip install whitenoise</td>
            </tr>
            <tr>
                <td>The "<a href="http://whitenoise.evans.io/en/stable/" target="_blank">WhiteNoise</a>" package serves
                    these compiled static files in production. <br> The command install's the latest version of the
                    "whiteNoise" package using pip.</td>
            </tr>
            <tr>
                <td>INSTALLED_APPS = [ ...<br>
                    <mark
                        title="add whitenoise to the INSTALLED_APPS above the built-in staticfiles app">"whitenoise.runserver_nostatic",</mark>
                    ...<br>
                    <hr>
                    MIDDLEWARE = [ ... <br>
                    <mark
                        title="under MIDDLEWARE add a new line for WhiteNoiseMiddleware">"whitenoise.middleware.WhiteNoiseMiddleware",</mark>
                    ...<br>
                    <hr>
                    STATICFILES_STORAGE =
                    <mark
                        title="change STATICFILES_STORAGE to use WhiteNoise">"whitenoise.storage.CompressedManifestStaticFilesStorage"</mark>
                </td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li><b>add</b> whitenoise to the INSTALLED_APPS above the built-in staticfiles app</li>
                        <li>under MIDDLEWARE <b>add</b> a new line for WhiteNoiseMiddleware</li>
                        <li><b>change</b> STATICFILES_STORAGE to use WhiteNoise</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>python manage.py collectstatic</td>
            </tr>
            <tr>
                <td>since the method has changed run collectstatic one more time to use whitenoise instead: <ul>
                        <li>There will be a short warning, This will overwrite existing files! Are you sure you want to
                            do this? Type “yes” and hit Enter. The collected static files are now regenerated in the
                            same staticfiles folder using WhiteNoise.</li>
                    </ul>
                </td>
            </tr>
        </table>

        <!-- testing //////////////////////////////////////////////////////////////////////////// -->
        <table class="codExplain">
            <tr>
                <th>testing</th>
            </tr>
            <tr>
                <td>python manage.py test</td>
            </tr>
            <tr>
                <td>runs the Django test in the terminal</td>
            </tr>
        </table>

        <!-- heroku login from cli -->
        <table class="codExplain">
            <tr>
                <th>heroku from the cli</th>
            </tr>
            <tr>
                <td>heroku login</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>activate first the "virtual environment"</li>
                        <li>log into "Heroku" from the command line</li>
                        <li>browser opens for authentication</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>heroku create <mark
                        title="name of the app, must be unique, if no name then random name is given">APP_NAME</mark>
                </td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>creating a new Heroku app, from the command line, Heroku will create a random
                            name for our app if no name is appended, for example: murmuring-plateau-30548 .</li>
                        <li>The heroku <b>create</b> command also creates a dedicated <b>remote</b> named heroku for our
                            app.</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>git remote -v</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>shows the remote repository's for "Git" and "Heroku"<br>
                            <p class="hiCode">
                                heroku https://git.heroku.com/murmuring-plateau-30548.git (fetch)<br>
                                heroku https://git.heroku.com/murmuring-plateau-30548.git (push)<br>
                                origin https://github.com/Zolske/django_test_helloWorld.git (fetch)<br>
                                origin https://github.com/Zolske/django_test_helloWorld.git (push)
                            </p>
                        </li>
                        <li>
                            This new remote means that as long as we include heroku in a command we have the ability to
                            both push and fetch code from Heroku now.
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>heroku config:set DISABLE_COLLECTSTATIC=1</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li><b>DO NOT CALL THE COMMAND IF YOU HAVE STATIC FILES BUT CALL IT IF YOU HAVE STATIC
                                FILES!!!</b></li>
                        <li>By default, Heroku runs Django's <code>collectstatic</code> command. Calling the above
                            command will prevent the default behavior and <b>ignores static files</b> like CSS and
                            JavaScript.
                        </li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>git push heroku main</td>
            </tr>
            <tr>
                <td>Adding <b>heroku</b> to the command sends the code also to Heroku.</td>
            </tr>
            <tr>
                <td>heroku ps:scale web=1</td>
            </tr>
            <tr>
                <td>Make's our Heroku app "live". As websites grow in traffic they need additional
                    Heroku services but for the basic's the lowest level (<i>web=1</i>) is enough.</td>
            </tr>
            <tr>
                <td>heroku open</td>
            </tr>
            <tr>
                <td>opens the "web browser" with the "life" version of our Heroku app</td>
            </tr>
        </table>

        <!-- deployment checklist -->
        <table class="codExplain">
            <tr>
                <th>deployment checklist (<i>make sure you are in the "virtual environment"</i>)</th>
            </tr>
            <tr>
                <td>python -m pip install gunicorn</td>
            </tr>
            <tr>
                <td>installs the web server "Gunicorn"</td>
            </tr>
            <tr>
                <td>python -m pip freeze > requirements.txt</td>
            </tr>
            <tr>
                <td>creates a a file which is conventionally called '<b>requirements.txt</b>' which contains all
                    dependency at the time the command was called, call command again to over write old requirements
                    with latest</td>
            </tr>
            <tr>
                <td>ALLOWED_HOSTS = [".herokuapp.com", "localhost", "127.0.0.1"]</td>
            </tr>
            <tr>
                <td>set the allowed hosts under <b>django_project/settings.py</b>
                    <ul>
                        <li>".herokuapp.com" allows heroku</li>
                        <li>"localhost", "127.0.0.1" allows local host</li>
                        <li>"*" allows all hosts, which is not very safe</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>web: gunicorn PROJECT_NAME.wsgi --log-file -</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>create a file named "<b>Procfile</b>" with no extension in the root directory</li>
                        <li>add the code which is shown above, PROJECT_NAME is the name of the Django project folder
                        </li>
                        <li>The Procfile is specific to Heroku and provides instructions on how to run the application
                            in
                            their stack.</li>
                        <li><b>web: gunicorn</b><br>
                            for the web function to use gunicorn as the server</li>
                        <li><b>django_project.wsgi</b><br>
                            to use the WSGI config file located at <mark
                                title="Django project folder">django_project</mark>.wsgi</li>
                        <li><b>--log-file -</b><br>
                            the flag --log-file - makes any logging messages visible to us</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>python-3.10.2</td>
            </tr>
            <tr>
                <td>
                    <ul>
                        <li>create a file named "<b>runtime.txt</b>" in the root directory (<i><a
                                    href="https://devcenter.heroku.com/articles/python-runtimes" target="_blank">Heroku
                                    doc 'runtime.txt'</a></i>)</li>
                        <li>add the version of python in the format shown above <ul>
                                <li>you can check the used python version with the command:<br>
                                    python --version</li>
                            </ul>
                        </li>
                    </ul>
                </td>
            </tr>
        </table>
    </main>
    <script src="../../js/add_navBarPython.js"></script>
</body>

</html>